<!DOCTYPE html>
<html lang="en">
  
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Typelevel Laika + Helium Theme" />
  <title>Key Concepts</title>
  
  
  <meta name="description" content="website2"/>
  
  
  
  <link rel="icon" sizes="32x32" type="image/svg+xml" href="../../img/indigo_logo_solid.svg"/>
  
  <link rel="icon" sizes="64x64" type="image/svg+xml" href="../../img/indigo_logo_solid.svg"/>
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700">
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:500">
  
  <link rel="stylesheet" type="text/css" href="../../helium/icofont.min.css" />
    <link rel="stylesheet" type="text/css" href="../../helium/laika-helium.css" />
    <link rel="stylesheet" type="text/css" href="../../css/custom.css" />
  <script src="../../helium/laika-helium.js"></script>
    <script src="../../01-quickstart/hello-indigo.md.js"></script>
    <script src="../../01-quickstart/mdoc.js"></script>
    <script src="../../03-gameloop/frame-context.md.js"></script>
    <script src="../../03-gameloop/mdoc.js"></script>
    <script src="../../03-gameloop/outcome.md.js"></script>
    <script src="../../06-presentation/materials.md.js"></script>
    <script src="../../06-presentation/cameras.md.js"></script>
    <script src="../../06-presentation/lighting.md.js"></script>
    <script src="../../06-presentation/depth.md.js"></script>
    <script src="../../06-presentation/clones-and-mutants.md.js"></script>
    <script src="../../06-presentation/animation.md.js"></script>
    <script src="../../06-presentation/layers.md.js"></script>
    <script src="../../06-presentation/audio.md.js"></script>
    <script src="../../06-presentation/scene-update-fragment.md.js"></script>
    <script src="../../06-presentation/boundaries.md.js"></script>
    <script src="../../06-presentation/shapes.md.js"></script>
    <script src="../../06-presentation/text-and-fonts.md.js"></script>
    <script src="../../06-presentation/mdoc.js"></script>
    <script src="../../08-time/signals.md.js"></script>
    <script src="../../08-time/mdoc.js"></script>
    <script src="../../08-time/time-varying-values.md.js"></script>
    <script src="../../07-shaders/blending.md.js"></script>
    <script src="../../07-shaders/mdoc.js"></script>
    <script src="../../07-shaders/shaders-overview.md.js"></script>
    <script src="../../09-uicomponents/button.md.js"></script>
    <script src="../../09-uicomponents/input-field.md.js"></script>
    <script src="../../09-uicomponents/hit-area.md.js"></script>
    <script src="../../09-uicomponents/radio-button.md.js"></script>
    <script src="../../09-uicomponents/mdoc.js"></script>
    <script src="../../04-organisation/scene-management.md.js"></script>
    <script src="../../04-organisation/boot-and-start-up.md.js"></script>
    <script src="../../04-organisation/subsystems.md.js"></script>
    <script src="../../04-organisation/mdoc.js"></script>
    <script src="../../02-guides/mdoc.js"></script>
    <script src="../../02-guides/howto-fire-shader.md.js"></script>
    <script src="../../02-guides/howto-custom-entity.md.js"></script>
    <script src="../../05-platform/assets.md.js"></script>
    <script src="../../05-platform/logging.md.js"></script>
    <script src="../../05-platform/mdoc.js"></script>
    <script src="../../05-platform/input-handling.md.js"></script>
    <script src="../key-concepts.md.js"></script>
    <script src="../antipatterns.md.js"></script>
    <script src="../mdoc.js"></script>
  
  
  <script> /* for avoiding page load transitions */ </script>
</head>

  <body>

    <header id="top-bar" class="light-default dark-default">

  <div class="row">
    <a id="nav-icon">
      <i class="icofont-laika navigationMenu" title="Navigation">&#xefa2;</i>
    </a>
    
    
  </div>

  <a class="image-link" href="../../"><img src="../../img/indigo_logo_solid_text.svg" alt="Homepage" title="Indigo" width="150" height="50"></a>

  <div class="row links">
    
    <a class="button-link" href="https://discord.gg/b5CD47g">Discord</a>
    
    <a class="button-link" href="/api">API</a>
    
    <a class="button-link" href="https://github.com/PurpleKingdomGames/indigo">Github</a>
    
  </div>  

</header>
    
    <nav id="sidebar">

  <div class="row">
    
    <a class="button-link" href="https://discord.gg/b5CD47g">Discord</a>
    
    <a class="button-link" href="/api">API</a>
    
    <a class="button-link" href="https://github.com/PurpleKingdomGames/indigo">Github</a>
    
  </div>

  <ul class="nav-list">
    <li class="level1 nav-leaf"><a href="../../table-of-content/">Contents</a></li>
    <li class="level1 nav-header">Setup &amp; Configuration</li>
    <li class="level2 nav-leaf"><a href="../../01-quickstart/examples/">Examples</a></li>
    <li class="level2 nav-leaf"><a href="../../01-quickstart/hello-indigo/">Hello, Indigo!</a></li>
    <li class="level2 nav-leaf"><a href="../../01-quickstart/project-templates/">Mill &amp; SBT Templates</a></li>
    <li class="level2 nav-leaf"><a href="../../01-quickstart/quickstart/">Quick start</a></li>
    <li class="level1 nav-header">Guides</li>
    <li class="level2 nav-leaf"><a href="../../02-guides/howto-custom-entity/">How to make a custom entity</a></li>
    <li class="level2 nav-leaf"><a href="../../02-guides/howto-fire-shader/">How to write a fire shader</a></li>
    <li class="level2 nav-leaf"><a href="../../02-guides/howto-hello-indigo-tyrian/">How to make a responsive UI using Tyrian</a></li>
    <li class="level2 nav-leaf"><a href="../../02-guides/howto-indigo-game/">Converting <code>IndigoSandbox</code> to <code>IndigoGame</code></a></li>
    <li class="level1 nav-header">Gameloop</li>
    <li class="level2 nav-leaf"><a href="../../03-gameloop/events/">Events</a></li>
    <li class="level2 nav-leaf"><a href="../../03-gameloop/frame-context/">Frame context</a></li>
    <li class="level2 nav-leaf"><a href="../../03-gameloop/outcome/">Outcome Type</a></li>
    <li class="level1 nav-header">Organisation</li>
    <li class="level2 nav-leaf"><a href="../../04-organisation/boot-and-start-up/">Boot &amp; Start Up</a></li>
    <li class="level2 nav-leaf"><a href="../../04-organisation/game-entry-points/">Game Entry Points</a></li>
    <li class="level2 nav-leaf"><a href="../../04-organisation/scene-management/">What are Scenes?</a></li>
    <li class="level2 nav-leaf"><a href="../../04-organisation/subsystems/">What SubSystems are</a></li>
    <li class="level1 nav-header">Platform &amp; IO</li>
    <li class="level2 nav-leaf"><a href="../../05-platform/assets/">Assets &amp; Asset Loading</a></li>
    <li class="level2 nav-leaf"><a href="../../05-platform/cross-platform-publishing/">Cross Platform Publishing</a></li>
    <li class="level2 nav-leaf"><a href="../../05-platform/importers/">File Importers</a></li>
    <li class="level2 nav-leaf"><a href="../../05-platform/input-handling/">Input Handling</a></li>
    <li class="level2 nav-leaf"><a href="../../05-platform/loading-and-saving-data/">Loading &amp; Saving Data</a></li>
    <li class="level2 nav-leaf"><a href="../../05-platform/logging/">Logging</a></li>
    <li class="level2 nav-leaf"><a href="../../05-platform/networking/">Networking</a></li>
    <li class="level1 nav-header">Presentation</li>
    <li class="level2 nav-leaf"><a href="../../06-presentation/animation/">Animation</a></li>
    <li class="level2 nav-leaf"><a href="../../06-presentation/audio/">Audio</a></li>
    <li class="level2 nav-leaf"><a href="../../06-presentation/boundaries/">Boundaries</a></li>
    <li class="level2 nav-leaf"><a href="../../06-presentation/cameras/">Cameras</a></li>
    <li class="level2 nav-leaf"><a href="../../06-presentation/clones-and-mutants/">Clones &amp; Mutants</a></li>
    <li class="level2 nav-leaf"><a href="../../06-presentation/depth/">Depth</a></li>
    <li class="level2 nav-leaf"><a href="../../06-presentation/layers/">Layers</a></li>
    <li class="level2 nav-leaf"><a href="../../06-presentation/lighting/">Lighting</a></li>
    <li class="level2 nav-leaf"><a href="../../06-presentation/materials/">Materials</a></li>
    <li class="level2 nav-leaf"><a href="../../06-presentation/primitives/">Primitives &amp; Building Blocks</a></li>
    <li class="level2 nav-leaf"><a href="../../06-presentation/scene-update-fragment/">SceneUpdateFragment</a></li>
    <li class="level2 nav-leaf"><a href="../../06-presentation/shapes/">Shapes</a></li>
    <li class="level2 nav-leaf"><a href="../../06-presentation/text-and-fonts/">Text &amp; Fonts</a></li>
    <li class="level1 nav-header">Shaders</li>
    <li class="level2 nav-leaf"><a href="../../07-shaders/blending/">Blending</a></li>
    <li class="level2 nav-leaf"><a href="../../07-shaders/constants/">Shader Constants, Variables, and Outputs</a></li>
    <li class="level2 nav-leaf"><a href="../../07-shaders/premultiplied-alpha/">Premultiplied Alpha</a></li>
    <li class="level2 nav-leaf"><a href="../../07-shaders/shaders-overview/">Shaders Overview</a></li>
    <li class="level1 nav-header">Time</li>
    <li class="level2 nav-leaf"><a href="../../08-time/gametime/">GameTime</a></li>
    <li class="level2 nav-leaf"><a href="../../08-time/signals/">Signals &amp; Signal Functions</a></li>
    <li class="level2 nav-leaf"><a href="../../08-time/time-varying-values/">Time Varying Values</a></li>
    <li class="level1 nav-header">UI Components</li>
    <li class="level2 nav-leaf"><a href="../../09-uicomponents/button/">Buttons</a></li>
    <li class="level2 nav-leaf"><a href="../../09-uicomponents/hit-area/">Hit Areas</a></li>
    <li class="level2 nav-leaf"><a href="../../09-uicomponents/input-field/">Input Fields</a></li>
    <li class="level2 nav-leaf"><a href="../../09-uicomponents/radio-button/">Radio Buttons</a></li>
    <li class="level2 nav-leaf"><a href="../../09-uicomponents/ui-components/">UI Components</a></li>
    <li class="level1 nav-header">Misc</li>
    <li class="level2 nav-leaf"><a href="../alternatives/">Alternatives to Indigo</a></li>
    <li class="level2 nav-leaf"><a href="../antipatterns/">Anti-Patterns</a></li>
    <li class="level2 nav-leaf"><a href="../glossary/">Glossary</a></li>
    <li class="level2 active nav-leaf"><a href="#">Key Concepts</a></li>
    <li class="level2 nav-leaf"><a href="../model-viewmodel-view/">Model, ViewModel, &amp; View</a></li>
    <li class="level2 nav-leaf"><a href="../motivation-and-constraints/">Motivation &amp; Constraints</a></li>
    <li class="level2 nav-leaf"><a href="../performance/">Performance</a></li>
    <li class="level2 nav-leaf"><a href="../prior-art/">Prior Art</a></li>
    <li class="level2 nav-leaf"><a href="../rendering-technology/">Rendering Technology</a></li>
  </ul>

</nav>

    <div id="container">

      
<nav id="page-nav">
  <p class="header"><a href="#">Key Concepts</a></p>

  <ul class="nav-list">
    <li class="level1 nav-leaf"><a href="#making-a-game-testable">Making a game testable</a></li>
    <li class="level1 nav-leaf"><a href="#your-whole-game-as-a-single-pure-stateless-function">&quot;Your whole game as a single, pure, stateless function.&quot;</a></li>
    <li class="level1 nav-leaf"><a href="#inputs-are-immutable-and-predictable">&nbsp;Inputs are immutable and predictable</a></li>
    <li class="level1 nav-leaf"><a href="#key-outputs-are-monoids">Key outputs are Monoids</a></li>
  </ul>

  <p class="footer"></p>
</nav>


      <main class="content">

        <h1 id="key-concepts" class="title">Key Concepts</h1>
        
        <h2 id="making-a-game-testable" class="section"><a class="anchor-link left" href="#making-a-game-testable"><i class="icofont-laika link">&#xef71;</i></a>Making a game testable</h2>
        <p>If you want to be able to test a single frame of a game, a whole frame, then you need one thing: Referential transparency.</p>
        <blockquote>An expression is called referentially transparent if it can be replaced with its corresponding value without changing the program&#39;s behavior. ~ John C. Mitchell (2002). Concepts in Programming Languages, <a href="https://en.wikipedia.org/wiki/Referential_transparency">via the wikipedia page on referential transparency</a>.</blockquote>
        <p><strong>It must be noted that referential transparency on the JVM or in JS are never absolute for various reasons, so we&#39;re working with a &quot;best endeavors&quot; approach.</strong></p>
        <p>Referential transparency allows you to ask for the next frame of a game, and compare it to the expected frame definition, confident that they will always always be equivalent, provided your expected value is correct. Which means that if you have referentially transparent frames, then you can test them! Example in made up pseudo code:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="comment">// pseudo code!
</span><span>
</span><span class="keyword">val</span><span> </span><span class="identifier">gameTime</span><span> = </span><span class="type-name">GameTime</span><span>.</span><span class="identifier">is</span><span>(</span><span class="type-name">Seconds</span><span>(</span><span class="number-literal">123</span><span>))

</span><span class="keyword">val</span><span> </span><span class="identifier">actual</span><span>: (</span><span class="type-name">Model</span><span>, </span><span class="type-name">View</span><span>) =
  </span><span class="type-name">MyGame</span><span>.</span><span class="identifier">calculateNextFrame</span><span>(</span><span class="identifier">gameTime</span><span>)

</span><span class="keyword">val</span><span> </span><span class="identifier">expected</span><span>: (</span><span class="type-name">Model</span><span>, </span><span class="type-name">View</span><span>) =
  (</span><span class="identifier">expectedModel</span><span>, </span><span class="identifier">expectedView</span><span>)

</span><span class="identifier">assert</span><span>(</span><span class="identifier">actual</span><span> == </span><span class="identifier">expected</span><span>)</span></code></pre>
        <p>The above would only hold true if there are no side effects. The problem is that games are random, time sensitive, and usually use mutable state for better performance - all of which are normally side effecting issues.</p>
        <p>Some of the key things that Indigo gives you:</p>
        <ol class="arabic">
          <li>Known time - each frame&#39;s logic gets one time value regardless of how long it takes to process the frame.</li>
          <li>Pseudo randomness - seeded from the game&#39;s running time, but you can always find out what &quot;random&quot; values were used provided you use a propagated <code>dice</code> instance.</li>
          <li>Immutability - the state and all inputs to a frame are immutable, leading to consistent results.</li>
          <li>Side effect free, declarative APIs - since your state is immutable you must describe what you&#39;d like to happen next, rather than being able to directly action it now. This all but eliminates race conditions.</li>
          <li>Predictable scene composition - <code>SceneUpdateFragment</code>s are combined very simply allowing you to test the view description in an ordinary unit test.</li>
        </ol>
        
        <h2 id="your-whole-game-as-a-single-pure-stateless-function" class="section"><a class="anchor-link left" href="#your-whole-game-as-a-single-pure-stateless-function"><i class="icofont-laika link">&#xef71;</i></a>&quot;Your whole game as a single, pure, stateless function.&quot;</h2>
        <p>The default interfaces you are presented with as part of Indigo&#39;s framework offer a range of functions and values that you need to decide how to implement, but that&#39;s all just there to improve the user experience.</p>
        <p>Beneath the APIs of the entry points is a <em>single function</em> that looks a bit like this:</p>
        <pre><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">indigo</span><span>.*

</span><span class="keyword">final</span><span> </span><span class="keyword">case</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">Model</span><span>(</span><span class="identifier">count</span><span>: </span><span class="type-name">Int</span><span>)
</span><span class="keyword">final</span><span> </span><span class="keyword">case</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">ViewModel</span><span>(</span><span class="identifier">position</span><span>: </span><span class="type-name">Point</span><span>)

</span><span class="keyword">def</span><span> </span><span class="declaration-name">run</span><span>(
      </span><span class="identifier">model</span><span>: </span><span class="type-name">Model</span><span>,
      </span><span class="identifier">viewModel</span><span>: </span><span class="type-name">ViewModel</span><span>,
      </span><span class="identifier">gameTime</span><span>: </span><span class="type-name">GameTime</span><span>,
      </span><span class="identifier">globalEvents</span><span>: </span><span class="type-name">Batch</span><span>[</span><span class="type-name">GlobalEvent</span><span>],
      </span><span class="identifier">inputState</span><span>: </span><span class="type-name">InputState</span><span>,
      </span><span class="identifier">dice</span><span>: </span><span class="type-name">Dice</span><span>,
      </span><span class="identifier">boundaryLocator</span><span>: </span><span class="type-name">BoundaryLocator</span><span>
  ): </span><span class="type-name">Outcome</span><span>[(</span><span class="type-name">Model</span><span>, </span><span class="type-name">ViewModel</span><span>, </span><span class="type-name">SceneUpdateFragment</span><span>)] = ???</span></code></pre>
        <p>The point of this function is purity: What you get out, should be a result of what you put in and nothing else.</p>
        <blockquote>Scala is an impure functional programming language, so you are not restricted to writing games that obey these notions of purity and referential transparency in the name of, say, performance -  but you should start there.</blockquote>
        
        <h2 id="inputs-are-immutable-and-predictable" class="section"><a class="anchor-link left" href="#inputs-are-immutable-and-predictable"><i class="icofont-laika link">&#xef71;</i></a>&nbsp;Inputs are immutable and predictable</h2>
        <p>It will come as no surprise to Scala functional programmers, but all of the inputs to the run function above are immutable. You can access them and read from them but you can&#39;t change them. This eliminates a whole class of errors around race conditions during frame evaluation.</p>
        <p>Walking through them one at a time:</p>
        <ul>
          <li><code>model: Model</code> - This is the read-only state of the model, as calculated by the previous frame (or the initial state).</li>
          <li><code>viewModel: ViewModel</code> - This is the read-only state of the view-model, as calculated by the previous frame (or the initial state).</li>
          <li><code>gameTime: GameTime</code> - Time information such as frame deltas, all based on the current running time of your game.</li>
          <li><code>globalEvents: Batch[GlobalEvent]</code> - <code>GlobalEvents</code> only live for one frame, and can only be accessed in the next frame. This list then, is all* of the events generated by the previous frame.</li>
          <li><code>inputState: InputState</code> - Represents the state of the keyboard, mouse and game pad.</li>
          <li><code>dice: Dice</code> - Pseudo random elements can be added using the provided <code>Dice</code> instance, which is seeded from the game&#39;s running time. (<strong><em>Warning: Dice start at 1, not 0 ...don&#39;t they...</em></strong>)</li>
          <li><code>boundaryLocator: BoundaryLocator</code> - A service that can be used to find the boundaries of scene elements.</li>
        </ul>
        <blockquote>*With the exception that some events, intended to instruct Indigo itself to do something, will not be available to the next frame. For example an emitted <code>PlaySound</code> event will be delivered to the Audio system, but not to the next frame.</blockquote>
        
        <h2 id="key-outputs-are-monoids" class="section"><a class="anchor-link left" href="#key-outputs-are-monoids"><i class="icofont-laika link">&#xef71;</i></a>Key outputs are Monoids</h2>
        <p>Some clarification, the return type of the function above is:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">outcome</span><span>: </span><span class="type-name">Outcome</span><span>[(</span><span class="type-name">Model</span><span>, </span><span class="type-name">ViewModel</span><span>, </span><span class="type-name">SceneUpdateFragment</span><span>)] = ???</span></code></pre>
        <p>&lt;div id=&quot;mdoc-html-run1&quot; data-mdoc-js&gt;&lt;/div&gt;</p>
        <p>But it&#39;s easier to think of this as:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">outcome</span><span>: (</span><span class="type-name">Model</span><span>, </span><span class="type-name">ViewModel</span><span>, </span><span class="type-name">SceneUpdateFragment</span><span>, </span><span class="type-name">Batch</span><span>[</span><span class="type-name">GlobalEvent</span><span>]) = ???</span></code></pre>
        <p>&lt;div id=&quot;mdoc-html-run2&quot; data-mdoc-js&gt;&lt;/div&gt;</p>
        <ol class="arabic">
          <li>An updated model</li>
          <li>An updated view model</li>
          <li>A new scene to draw (<code>SceneUpdateFragment</code>)</li>
          <li>A list of events to be processed and passed to the relevant systems or the next frame. (<code>Batch[GlobalEvent]</code>)</li>
        </ol>
        <p>The first two, the model and view model, are not really used by the indigo engine at all, they are simply recorded and passed as input to the next frame.</p>
        <p>The <code>SceneUpdateFragment</code> and <code>Batch[GlobalEvent]</code> however are critical as they are the instructions that tell Indigo what side effects to produce. Rendering graphics, playing sounds, storing and fetching data, communicating over a network, etc.</p>
        <p>Since the scene and events can be produced as outputs from a range of processes, it&#39;s essential that they can be combined reliably and predictably so that they can be tested (hence, Monoidal).</p>
        <p>This has the incredibly useful property that you don&#39;t need to describe your frame&#39;s results (graph and events) all in one go. You can define them in little modules (such as Indigo&#39;s <code>SubSystem</code>s) and be sure that Indigo will combine them in a predictable and test friendly way when the game is run.
        &lt;script type=&quot;text/javascript&quot; src=&quot;key-concepts.md.js&quot; defer&gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;mdoc.js&quot; defer&gt;&lt;/script&gt;</p>

        
<hr class="footer-rule"/>
<footer>
  Site generated by <a href="https://typelevel.org/Laika/">Laika</a> with the Helium theme.
</footer>


      </main>

    </div>

  </body>

</html>